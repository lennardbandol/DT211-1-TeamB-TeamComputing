#pragma config(Sensor, S1,     lightsensor,    sensorLightActive)
#pragma config(Sensor, S4,     sonarsensor,    sensorSONAR)
#pragma config(Motor,  motorA,          rightmotor,    tmotorNXT, PIDControl, encoder)
#pragma config(Motor,  motorB,          leftmotor,     tmotorNXT, PIDControl, encoder)
//*!!Code automatically generated by 'ROBOTC' configuration wizard               !!*//

/* Team computing Assignment */

//declaring global variables
int lightValue;
int darkValue;
int sumValue;
int thresholdValue;
int countValue = 0;
int lastSeen;
int speed = 20;

//function prototype
void turnleft();
void forward();
void turnright();
void findthreshold();
void detectblackcell();


task main()
{
	detectblackcell():
}

//function to turn left
void turnleft()
{

	nMotorEncoder[rightmotor] = 0;
	while(nMotorEncoder[rightmotor] < 163)
	{
		motor[leftmotor] = -speed;
		motor[rightmotor] = speed;
	}

	motor[rightmotor] = 0;
	motor[leftmotor] = 0;
	wait1Msec(1000);

}

//function to turn right
void turnright()
{

	nMotorEncoder[leftmotor] = 0;
	while(nMotorEncoder[leftmotor] < 163)
	{
		motor[leftmotor] = speed;
		motor[rightmotor] = -speed;
	}

	motor[rightmotor] = 0;
	motor[leftmotor] = 0;
	wait1Msec(1000);

}

//function to move forward
void forward()
{

	nMotorEncoder[rightmotor] = 0;
	while(nMotorEncoder[rightmotor] < 270)
	{
		motor[leftmotor] = speed;
		motor[rightmotor] = speed;
	}

	motor[rightmotor] = 0;
	motor[leftmotor] = 0;
	wait1Msec(1000);

}

//function to find the threshold values.

/* void findthreshold()
{

	while(SensorValue(touchsensor) == 0)
  {
    nxtDisplayStringAt(0,31,"Read Light Now");
  }

  lightValue = SensorValue(lightsensor);

  wait1Msec(1000);

  while(SensorValue(touchsensor) == 0)
  {
    nxtDisplayStringAt(0,31,"Read Dark Now");
  }

  darkValue = SensorValue(lightsensor);

  sumValue = lightValue + darkValue;
  thresholdValue = sumValue/2;

}

*/

void detectblackcell()
{
	while ( 1 )
	{
		turnleft();
		if( SensorValue(lightsensor) < 30 ) //if detecting black line
		{
			turnright(); //facenorth
		}
		turnright();
		turnright();
		if( SensorValue(lightsensor < 30 )) //if detecting black line
		{
			turnleft(); //face north
		}
		forward();


		if( sensorvalue(lightsensor) < 30 )
		{
			turnleft();
			if( sensorvalue(lightsensor) < 30 )
			{
				turnright();
				turnright();
				forward();
			}
			forward();
		}
	}
}



